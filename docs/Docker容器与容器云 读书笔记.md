# Docker容器与容器云 读书笔记
* Author:LincolnWung
* Date:20170425

# 术语

1. 特性维护者(maintainer)
2. 代码贡献者(contributor)
3. [The Twelve-Factor App](https://12factor.net/zh_cn/)

# 前言

1. 类比, Docker ,数据中心运维系统
2. 类比, Docker ,虚拟机在资源利用率和性能上的对比

# 第一章 从容器到容器云

>云计算是一种按使用量付费的模式，该模式提供可用的、便捷的、按需的网络访问， 纳入可配置的计算资源共享池（资源包括网络、服务器、存储、应用软件、服务），统一管理的资源能够被快速提供，大大减少了资源管理工作开销，你甚至可以再也不用理会那些令人头痛的传统服务供应商了。

经典云计算架构包括了IaaS（Infrastructure as a Service，基础设施即服务）、PaaS（Platform as a Service，平台即服务）、SaaS（Software as a Service，软件即服务）三层服务，如图1-1所示。
![](http://epub.ituring.com.cn/api/storage/getbykey/screenshow?key=1505bf8b6d40c1a04597)

* IaaS层为基础设施运维人员服务，提供计算、存储、网络及其他基础资源，云平台使用者可以在上面部署和运行包括操作系统和应用程序在内的任意软件，无需再为基础设施的管理而分心。

* PaaS层为应用开发人员服务，提供支撑应用运行所需的软件运行时环境、相关工具与服务，如数据库服务、日志服务、监控服务等，让应用开发者可以专注于核心业务的开发。

* SaaS层一般为用户服务，提供了一套完整可用的软件系统，让一般用户无需关注技术细节，只需通过浏览器、应用客户端等方式就能使用部署在云上的应用服务。


IaaS的发展主要以虚拟机为最小粒度的资源调度单位，出现了资源利用率低、调度分发缓慢、软件堆栈环境不统一等一堆问题。PaaS在IaaS基础上发展而来，众多PaaS已经意识到可以利用容器技术解决资源利用率问题，但是PaaS通常在应用架构选择、支持的软件环境服务方面有较大的限制，这带来了应用与平台无法解耦、应用运行时环境局限性强、运维人员控制力下降的问题。


## Docker是什么？

>基于官方的定义，Docker是以Docker容器为资源分割和调度的基本单位，封装整个软件运行时环境，为开发者和系统管理员设计的，用于构建、发布和运行分布式应用的平台。它是一个跨平台、可移植并且简单易用的容器解决方案。Docker的源代码托管在GitHub上，基于Go语言开发并遵从Apache 2.0协议。Docker可在容器内部快速自动化地部署应用，并通过内核技术（namespaces、cgroups等）为容器提供资源隔离与安全保障。
一个软件项目的成功常常需要依托其衍生的生态系统，围绕或基于核心技术而构建的相关项目日臻丰富和完善，软件本身的功能和易用性也随之增加，Docker的迅猛发展与其强大的生态系统息息相关。首先我们从图1-3中整体上来审视一下它。

![](http://epub.ituring.com.cn/api/storage/getbykey/screenshow?key=1505f21ef12a2e759c69)

图1-3 Docker生态系统

如图1-3，围绕Docker的生态系统自下而上分别覆盖了IaaS层和PaaS层所涉及的各类问题，包括资源调度、编排、部署、配置管理、网络管理、应用开发和部署平台、应用开发工具、应用服务供应以及大数据分析等云计算相关的服务。除了基于Docker技术解决构建分布式平台无法回避的经典问题，Docker及其生态系统主要带来了以下几点好处。

持续部署与测试。Docker消除了线上线下的环境差异，保证了应用生命周期的环境一致性和标准化。开发人员使用镜像实现标准开发环境的构建，开发完成后通过封装着完整环境和应用的镜像进行迁移，由此，测试和运维人员可以直接部署软件镜像来进行测试和发布，大大简化了持续集成、测试和发布的过程。
跨云平台支持。Docker带来的最大好处之一就是其适配性，越来越多的云平台都支持Docker，用户再也无需担心受到云平台的捆绑，同时也让应用多平台混合部署成为可能。目前支持Docker的IaaS云平台包括但不限于亚马逊云平台（AWS）、Google云平台（GCP）、微软云平台（Azure）、OpenStack等，还包括如Chef、Puppet、Ansible等配置管理工具。
环境标准化和版本控制。基于Docker提供的环境一致性和标准化，你可以使用git等工具对Docker镜像进行版本控制，相比基于代码的版本控制来说，你还能够对整个应用运行环境实现版本控制，一旦出现故障可以快速回滚。相比以前的虚拟机镜像，Docker压缩和备份速度更快，镜像启动也像启动一个普通进程一样快速。
高资源利用率与隔离。Docker容器没有管理程序的额外开销，与底层共享操作系统，性能更加优良，系统负载更低，在同等条件下可以运行更多的应用实例，可以更充分地利用系统资源。同时，Docker拥有不错的资源隔离与限制能力，可以精确地对应用分配CPU、内存等资源，保证了应用间不会相互影响。
容器便携性与镜像。Linux容器虽然早在Linux 2.6版本内核已经存在，但是缺少容器的便携性，难以推广。Docker在原有Linux容器的基础上进行大胆革新，为容器设定了一整套标准化的配置方法，将应用及其依赖的运行环境打包成镜像，真正实现了“构建一次，到处运行”的理念，大大提高了容器的便携性。
易于理解且易用。Docker的英文原意是处理集装箱的码头工人，标志是鲸鱼运送一大堆集装箱，集装箱就是容器，生动好记，易于理解。一个开发者可以在15分钟之内入门Docker并进行安装和部署，这是容器使用史上的一次飞跃。因为它的易用性，有更多的人开始关注容器技术，加速了容器标准化的步伐。
应用镜像仓库。Docker官方构建了一个镜像仓库，组织和管理形式类似于GitHub，其上已累积了成千上万的镜像。因为Docker的跨平台适配性，相当于为用户提供了一个非常有用的应用商店，所有人都可以自由地下载微服务组件，这为开发者提供了巨大便利。

## 什么是容器云？


>容器云以容器为资源分割和调度的基本单位，封装整个软件运行时环境，为开发者和系统管理员提供用于构建、发布和运行分布式应用的平台。当容器云专注于资源共享与隔离、容器编排与部署时，它是一种IaaS；当容器云渗透到应用支撑与运行时环境时，它是一种PaaS。

容器云并不仅限于Docker，基于rkt容器的CoreOS项目也是容器云。Docker的出现让人们意识到了容器的价值，使得一直以来长期存在但并未被重视的轻量级虚拟化技术得到快速的发展和应用。鉴于Docker的里程碑意义，本书在讨论容器云时，都以分析Docker为支撑技术的容器云为主。


## **Docker子命令分类**

子命令分类      | 子命令                                                        
---------- | -----------------------------------------------------------
Docker环境信息 | info、version                                               
容器生命周期管理   | create、exec、kill、pause、restart、rm、run、start、stop、unpause   
镜像仓库命令     | login、logout、pull、push、search                              
镜像管理       | build、images、import、load、rmi、save、tag、commit               
容器运维操作     | attach、export、inspect、port、ps、rename、stats、top、wait、cp、diff
系统日志信息     | events、history、logs    


## Docker命令结构图

[Dokcer常用管理命令](https://segmentfault.com/a/1190000000751601)

![](https://segmentfault.com/img/bVdlRG)                                    